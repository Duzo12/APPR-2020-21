---
title: "Meddržavne selitve v Sloveniji"
author: "Klara Širca"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme
Za temo sem si izbrala analizo meddržavnih selitev v Sloveniji: priseljevanja v Slovenijo ter izseljevanja iz Slovenije. Analizirala bom, kako so se selitve gibale skozi čas ter kakšni ljudje so se k nam priseljevali ter od nas odseljevali. Za konec bom priseljevanje primerjala še z drugimi evropskimi državami.

![](slike/migracija.jpg)

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke sem uvozila iz Statističnega urada Republike Slovenije, Eurostata (Evropska statistika) ter Wikipedije. Imam 11 tabel v obliki csv in 1 v obliki html.

1. `tabela1` - podatki o številu priseljenih ljudi v Slovenijo, letno
    - `Leto` - spremenljivka: leto meritve (2011-2020)
    - `Drzava` - spremenljivka: država iz katere prihajajo priseljenci
    - `Spol` - spremenljivka: moški ali ženske
    - `Priseljeni_iz_tujine` - meritev: število priseljenih ljudi iz določene države v Slovenijo
    
2. `tabela2` - podatki o številu odseljenih ljudi iz Slovenije, letno
    - `Leto` - spremenljivka: leto meritve (2011-2020)
    - `Drzava_prihodnjega_bivalisca` - spremenljivka: država v katero odhajajo  izseljenci
    - `Spol` - spremenljivka: moški ali ženske
    - `Odseljeni_v_tujino` - meritev: število izseljenih ljudi v določeno država iz Slovenije

3. `tabela3` - podatki o številu izseljenih ljudi iz Slovenije glede na starostno skupino
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Starost` - spremenljivka: starostna skupina odseljenih prebivalcev Slovenije
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo_odseljenih` - meritev: število odseljenih ljudi določene starostne skupine v določenem obdobju
    
    
4. `tabela4` - podatki o številu priseljenih ljudi iz Slovenije glede na starostno skupino
    - `Leto` - spremenljivka: leto meritve (2011-2020)
    - `Drazva` - spremenljivka: drzava, iz katere prihajajo priseljenci
    - `Starost` - spremenljivka: starostna skupina priseljenih prebivalcev Slovenije
    - `Stevilo_priseljenih` - meritev: število priseljenih ljudi določene starostne skupine v določenem obdobju   
    
5. `tabela5` - podatki o stevilu odseljenih ljudi glede na izobrazbo
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Drazva_prihodnjega_bivalisca` - spremenljivka: drzava, v katero odhajajo izseljenci
    - `Izobrazba` - spremenljivka: izobrazba odseljenih ljudi (osnovnošolska ali manj, srednješolska, višješolska)
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število odseljenih ljudi določene izobrazbe v določenem obdobju    
    

6. `tabela6` - podatki o stevilu priseljenih ljudi glede na izobrazbo
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Drazva` - spremenljivka: drzava, iz katere prihajajo priseljenci
    - `Izobrazba` - spremenljivka: izobrazba priseljenih ljudi (osnovnošolska ali manj, srednješolska, višješolska)
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število priseljenih ljudi določene izobrazbe v določenem obdobju   

7. `tabela7` - podatki o stevilu priseljenih ljudi glede na namen selitve
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Drazva` - spremenljivka: drzava, iz katere prihajajo priseljenci
    - `Namen` - spremenljivka: namen selitve v Slovenijo
    - `Stevilo` - meritev: število priseljenih ljudi glede na določen namen v določenem obdobju
    

8. `tabela8` - podatki o stevilu priseljenih zaposlenih ljudi glede na dejavnost, s katero se ukvarjajo
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Dejavnost` - spremenljivka: dejavnost, s katero se ukvarjajo priseljenci
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število zaposlenih priseljencev glede na dejavnost, s katero se ukvarjajo, v določenem obdobju
    
9. `tabela9` - podatki o stevilu odseljenih zaposlenih ljudi glede na dejavnost, s katero se ukvarjajo
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Dejavnost` - spremenljivka: dejavnost, s katero se ukvarjajo odseljeni iz Slovenije
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število zaposlenih odseljenih ljudi glede na dejavnost, s katero se ukvarjajo, v določenem obdobju  
    

10. `tabela10` - podatki o BDP na prebivalca za različne evropske države
    - `Leto` - spremenljivka: leto meritve in napovedi (2016-2026)
    - `Drzava` - spremenljivka: drzava
    - `GDP_per_capita_dolarji` - meritev: BDP na prebivaca v določenem obdobju, za leta 2022-2026 tudi napovedi
    
11. `tabela11` - podatki o številu priseljenih ljudi v določeno državo, letno
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Drzava` - spremenljivka: država
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število priseljenih ljudi v državo v določenem obdobju
    
12. `tabela12` - podatki o številu odseljenih ljudi iz določene države, letno
    - `Leto` - spremenljivka: leto meritve (2011-2019)
    - `Drzava` - spremenljivka: država
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število odseljenih ljudi iz države v določenem obdobju

13. `tabela13` - podatki o številu odseljenih ljudi iz različnih regij v tujino
    - `Leto` - spremenljivka: leto meritve (2011-2020)
    - `Regija` - spremenljivka: regije Slovenije
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo_odseljenih_v_tujino` - meritev: število odseljenih ljudi iz različnih regij v tujino v določenem obdobju

12. `tabela14` - podatki o številu priseljenih ljudi v različne regije Slovenije iz tujine
    - `Leto` - spremenljivka: leto meritve (2011-2020)
    - `Drzava` - spremenljivka: regije Slovenije
    - `Spol` - spremenljivka: moški ali ženske
    - `Stevilo` - meritev: število priseljenih ljudi v različne regije v določenem obdobju
  
***

# Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Spodnji zemljevid prikazuje povprečno velikost družine za vsako občino.

```{r zemljevid, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
tm_shape(merge(zemljevid, povprecja, by.x="OB_UIME", by.y="obcina")) +
  tm_polygons("povprecje", title="Povprečje") +
  tm_layout(title="Povprečno število otrok v družini")
```

***

# Napredna analiza podatkov

```{r analiza}
source("analiza/analiza.r", encoding="UTF-8")
```

Spodnji graf prikazuje povezavo med številom naselij in površino občine.

```{r graf, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
ggplot(inner_join(obcine, data.frame(obcina=names(skupine),
                                     skupina=factor(skupine)), by="obcina")
, aes(x=povrsina, y=naselja, color=skupina, size=prebivalci/1000)) + geom_point() +
  ggtitle("Število naselij glede na površino občine") +
  xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") +
  guides(color=guide_legend(title="Skupina"),
         size=guide_legend(title="Prebivalci (* 1000)"))
```

***

```{r shiny}
shinyAppDir("shiny", options=list(width="100%", height=600))
```
