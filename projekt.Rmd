---
title: "Analiza turizma v Sloveniji"
author: "Žiga Gartner"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
  runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Izbira teme

Analiziral bom turizem v Sloveniji. Analiziral bom gibanje prenočitev in turističnih
kapacitet za posamezen tip turističnih občin, demografsko sestavo turistov in 
gibanje števila vseh prihodov in prenočitev. Za konec bom analiziral še
število prihodov v posameznih občinah. Večinoma so podatki za obdobje 2010-2019.




***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Podatke smo uvozili s statističnega urada Republike Slovenije v obliki CSV in v obliki HTML
z Wikipedije. Podatke imamo v petih razpredelnicah v obliki *tidy data*.

1. `prenocitve.tipi` - podatki o prenočitvah za posamezen tip turističnih občin
  - `Tip` - spremenljivka: tip turistične občine,
  - `Leto` - spremenljivka: leto meritve,
  - `Stevilo` - meritev: število prenočitev v ustreznem tipu turistične občine.

2. `obcine_prihodi` - podatki o prihodih za posamezno občino
  - `Obcina` - spremenljivka: ime občine,
  - `Leto` - spremenljivka: leto meritve,
  - `Stevilo` - meritev: število prihodov za ustrezno občino.

3. `vsi.gosti` - število vseh gostov v Sloveniji
  - `Tip` - spremenljivka: tip gosta,
  - `Leto` - spremenljivka: leto meritve,
  - `Stevilo` - meritev: število gostov za ustrezen tip.
  
4. `vse.prenocitve` - število vseh prenočitev v Sloveniji
  - `Tip` - spremenljivka: tip gosta,
  - `Leto` - spremenljivka: leto meritve,
  - `Stevilo` - meritev: število prenočitev za ustrezen tip gosta.
  
5. `kapacitete.vrste.obcin` - podatki o turističnih kapacitetah za posamezen tip turističnih občin
  - `Tip` - spremenljivka: tip turistične občine,
  - `Leto` - spremenljivka: leto meritve,
  - `Stevilo` - meritev: obseg turističnih kapacitet v ustreznem tipu turistične občine.  



***

# Analiza in vizualizacija podatkov

```{r vizualizacija, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

```{r graf.vseh.prenocitev, echo=FALSE, fig.align='center'}
graf.vseh.prenocitev
```

Graf prikazuje število vseh prenočitev turistov v Sloveniji.
Opazimo, da v zadnjih dveh destletjih število vseh prenočitev
turistov stabilno narašča. Padec se je zgodil le med letoma 2008
in 2009, najverjetneje zaradi gospodarske krize.



```{r, echo=FALSE, fig.align='center'}
shinyApp(ui <- fluidPage(
  theme=shinytheme("lumen"),
  headerPanel("Število prenočitev po tipu turističnih občin"),
  fluidRow(sidebarLayout(sidebarPanel(checkboxGroupInput("izbira", label =strong("Tip občine"),
                                        choices=c("Zdraviliške"="Zdraviliške obcine",
                                                  "Gorske"="Gorske obcine" ,
                                                    "Obmorske"="Obmorske obcine",
                                                  "Ljubljana"="Ljubljana",
                                                    "Mestne"="Mestne obcine",
                                                  "Ostale"="Ostale obcine"),
                                        selected=c("Zdraviliške obcine",
                                                   "Gorske obcine",
                                                   "Obmorske obcine",
                                                   "Ljubljana",
                                                   "Mestne obcine",
                                                   "Ostale obcine"))),
                                        mainPanel(plotOutput("plot"))))),

server<- function(input,output){
  output$plot <- renderPlot({
    datoteka <- prenocitve.tipi.mio[prenocitve.tipi.mio$Tip %in% input$izbira,]
    
    g <- ggplot(datoteka) +
          aes(x=Leto, y=Stevilo, group=Tip, colour=Tip) +
          geom_point(size=2) +
          geom_line(size=1) +
          labs(y="Število prenočitev (milijoni)", x="Leto") +
          theme_hc() +
          scale_x_continuous(limits=c(2010, 2019), breaks=seq(2010, 2019, 1)) +
          scale_y_continuous(limits=c(0, 5),
                            breaks=seq(0,5, 0.5)) +
          scale_color_discrete(name = "Tip turistične občine")
    return(g)
  })
},
options = list(width="100%", height=500))
```

V aplikaciji si lahko pogledamo kako se je v zadnjem desetletju gibalo
število vseh prenočitev turistov glede na posamezen tip turističnih občin v
Sloveniji. Največjo rast števila prenočitev opazimo v gorskih občinah in 
v Ljubljani. Najmanjšo rast števila prenočitev v preteklem desetletju pa so
imele zdraviliške in mestne občine.



```{r shiny, echo=FALSE, fig.align='center'}
shinyAppDir("shiny", options=list(width="100%", height=500))
```

Aplikacija prikazuje število vseh prihodov po posameznih občinah v
Sloveniji za leto 2019 in leto 2018. Opazimo, da so največ prihodov zabeležile
občine na območju Triglavskega narodnega parka, Obalno-kraške regije in
Osrednje slovenske regije ter posamezne občine v preostalih delih Slovenije.
Prav tako opazimo, da ni bistvene razlike med prihodi po posameznih občinah za
obe leti. Število prihodov se je opazno povečalo le v nekaterih občinah,
npr. Gorje in Brežice, najdemo pa tudi občine v katerih se je število
prihodov zmanjšalo npr. Loška dolina in Renče-Vogrsko.



```{r diagram.vseh.gostov, echo=FALSE, fig.align='center'}
diagram.vseh.gostov
```

Na grafu je prikazana demografska sestava gostov v Sloveniji. Opazimo,
da je v zadnjih letih tujih gostov precej več kot domačih. Povečujeta se
obe števili, vendar število tujih hitreje kot število domačih. Število tujih 
gostov se je povečevalo vsa leta, razen med gospodarsko krizo leta 2009.



```{r graf.zmogljivosti.tipi, echo=FALSE, fig.align='center'}
graf.zmogljivosti.tipi
```

Grafi prikazujejo število prenočitvenih zmogljivosti za posamezen tip
turističnih občin v zadnjem desetletju. Prenočitvene zmogljivosti so se
najbolj povečale v gorskih občinah in v obmorskih občinah, najmanj pa v
mestnih občinah in zdraviliških občinah.



```{r graf.zmogljivosti.rast, echo=FALSE, fig.align='center'}
graf.zmogljivosti.rast
```

Na grafih so prikazane letne odstotne rasti prenočitvenih zmogljivosti
za posamezen tip turističnih občin. Najvišja letna rast prenočitvenih 
zmogljivosti je nastopila v mestnih občinah leta 2012, najvišji
padec pa v Ljubljani leta 2019.




***

# Napredna analiza podatkov

```{r analiza, echo=FALSE, message=FALSE, warning=FALSE}
source("analiza/analiza.r", encoding = "UTF-8")
```

```{r graf_k, echo=FALSE, fig.align='center'}
graf_k
```

```{r graf_r, echo=FALSE, fig.align='center'}
graf_r
```


